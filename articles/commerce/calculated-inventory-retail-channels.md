---
title: Beregning af lagertilgængelighed for detailkanaler
description: I dette emne beskrives de indstillinger, der er tilgængelige for visning af butikkens og onlinekanalernes disponible lager.
author: hhainesms
manager: annbe
ms.date: 08/13/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-commerce
ms.technology: ''
audience: Application User
ms.reviewer: v-chgri
ms.search.scope: Retail, Core, Operations
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: hhainesms
ms.search.validFrom: 2020-02-11
ms.dyn365.ops.version: Release 10.0.10
ms.openlocfilehash: 6d25a426268ebfb6990eb3dadb1ad451f86f59a1
ms.sourcegitcommit: 65a8681c46a1d99e7ff712094f472d5612455ff0
ms.translationtype: HT
ms.contentlocale: da-DK
ms.lasthandoff: 08/13/2020
ms.locfileid: "3694916"
---
# <a name="calculate-inventory-availability-for-retail-channels"></a><span data-ttu-id="04896-103">Beregning af lagertilgængelighed for detailkanaler</span><span class="sxs-lookup"><span data-stu-id="04896-103">Calculate inventory availability for retail channels</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="04896-104">I dette emne beskrives det, hvordan et firma kan bruge Microsoft Dynamics 365 Commerce til at få vist den forkalkulerede disponible tilgængelighed for produkter i online- og butikskanalerne.</span><span class="sxs-lookup"><span data-stu-id="04896-104">This topic describes how a company can use Microsoft Dynamics 365 Commerce to view estimated on-hand availability for products in the online and store channels.</span></span>

## <a name="accuracy-of-calculation"></a><span data-ttu-id="04896-105">Nøjagtigheden af beregningen</span><span class="sxs-lookup"><span data-stu-id="04896-105">Accuracy of calculation</span></span>

<span data-ttu-id="04896-106">I Commerce anvendes flere servere og databaser for at sikre skalerbarhed og ydeevne.</span><span class="sxs-lookup"><span data-stu-id="04896-106">Commerce uses multiple servers and databases to ensure scalability and performance.</span></span> <span data-ttu-id="04896-107">Derfor er det vigtigt, at du forstår, at de tilgængelige lagerværdier, som leveres gennem POS-programmet (Point Of Sale), e-Commerce-lagertilgængeligheds-API'erne (Application Programming Interface), og de disponible lagersider i Commerce Headquarters muligvis ikke er 100 procent nøjagtige i realtid.</span><span class="sxs-lookup"><span data-stu-id="04896-107">Therefore, it's important that you understand that the available inventory values that are provided through the point of sale (POS) application, the e-Commerce inventory availability application programming interfaces (APIs), and the on-hand inventory pages in Commerce Headquarters might not be 100-percent accurate in real time.</span></span> <span data-ttu-id="04896-108">Hvis transaktioner, der er oprettet for produkter i online- eller butikskanalen, endnu ikke er synkroniseret med Commerce Headquarters-serveren og -databasen, vil de disponible lagerbeholdningssider i Commerce Headquarters muligvis ikke vise en præcis lagerværdi i realtid for disse produkter.</span><span class="sxs-lookup"><span data-stu-id="04896-108">If transactions that are created for products in the online or store channel haven't yet been synced to the Commerce Headquarters server and database, the on-hand inventory pages in Commerce Headquarters might not show an accurate real-time inventory value for those products.</span></span> <span data-ttu-id="04896-109">Hvis du på den anden side konfigurerede din virksomhed, så brugere i Commerce Headquarters eller andre integrerede programmer kan sælge, modtage, returnere eller på anden måde justere lager ud af en butik eller et online lager, vil POS eller den online kanal muligvis ikke have alle de oplysninger, som er nødvendige for at vise en nøjagtig disponibel værdi for varer i realtid.</span><span class="sxs-lookup"><span data-stu-id="04896-109">Conversely, if you configured your company so that users in Commerce Headquarters or other integrated applications can sell, receive, return, or otherwise adjust inventory out of a store or online warehouse, the POS or online channel might not have all the information that is required to show an accurate real-time on-hand value for items.</span></span>

<span data-ttu-id="04896-110">I dette emne forklares de datasynkroniseringsprocesser, der kan køres hyppigt med henblik på at begrænse ventetiden for data mellem programmer eller kanaler.</span><span class="sxs-lookup"><span data-stu-id="04896-110">This topic explains the data synchronization processes that can be run frequently to help limit the latency of data between applications or channels.</span></span> <span data-ttu-id="04896-111">Det er dog vigtigt, at du forstår, at alle disponible tilgængelighedsdata, der angives i løbet af arbejdsdagen, anses for at være en estimeret værdi.</span><span class="sxs-lookup"><span data-stu-id="04896-111">However, it's critical that you understand that all on-hand availability data that is provided during the operational day is considered an estimated value.</span></span> <span data-ttu-id="04896-112">Hvis du derfor prøver at sammenligne oplysningerne om det disponible lager, som programmet leverer, med det faktiske fysiske lager på hylderne, eller hvis du prøver at sammenligne de disponible værdier, som vises i POS, med de disponible data, som du finder i det samme lager i Commerce Headquarters, kan værdierne være forskellige.</span><span class="sxs-lookup"><span data-stu-id="04896-112">Therefore, if you try to compare the on-hand inventory information that the application provides with actual physical inventory on the shelves, or if you try to compare the on-hand values that are shown in POS with the on-hand data that you find for the same warehouse in Commerce Headquarters, the values might differ.</span></span> <span data-ttu-id="04896-113">Denne forskel i løbet af arbejdsdagen er forventelig og bør ikke betragtes som et problem.</span><span class="sxs-lookup"><span data-stu-id="04896-113">This difference during the operational day is expected and should not be considered an issue.</span></span> <span data-ttu-id="04896-114">Hvis du vil revidere data og sikre, at de værdier, som leveres i lagertilgængeligheds-API'erne og Commerce Headquarters, matcher de faktiske fysiske enheder, som du finder i din butik eller på lagerets hylder, er den bedste tid at gøre det på, efter at kanalhandlinger er stoppet om dagen, og alle transaktioner er blevet korrekt synkroniseret mellem Commerce Headquarters og kanalen.</span><span class="sxs-lookup"><span data-stu-id="04896-114">If you want to audit data and make sure that the values that are provided in the inventory availability APIs and Commerce Headquarters match the actual physical units that you find on your store or warehouse shelves, the best time to do it is after channel operations have stopped for the day and all transactions have been correctly synced between Commerce Headquarters and the channel.</span></span>

## <a name="use-inventory-lookup-apis-for-e-commerce-inventory-availability-requests"></a><span data-ttu-id="04896-115">Brug API'er til lagersøgning til e-Commerce-anmodninger om lagertilgængelighed</span><span class="sxs-lookup"><span data-stu-id="04896-115">Use inventory lookup APIs for e-Commerce inventory availability requests</span></span>

<span data-ttu-id="04896-116">Du kan bruge følgende API'er til at få vist lagertilgængeligheden for et produkt, når kunderne handler på et e-Commerce-websted.</span><span class="sxs-lookup"><span data-stu-id="04896-116">You can use the following APIs to show inventory availability for a product when your customers are shopping on an e-Commerce site.</span></span>

- <span data-ttu-id="04896-117">**GetEstimatedAvailability** – Brug denne API til at få oplyst lagertilgængeligheden for varen på e-Commerce-kanalens lagersted eller alle de lagersteder, der er knyttet til konfigurationen af ordreopfyldningsgruppen for e-Commerce-kanalen.</span><span class="sxs-lookup"><span data-stu-id="04896-117">**GetEstimatedAvailability** – Use this API to get inventory availability for the item in the e-Commerce channel warehouse or all warehouses that are linked to the configuration of the fulfillment group for the e-Commerce channel.</span></span> <span data-ttu-id="04896-118">Denne API kan også bruges til lagersteder i et specifikt søgeområde eller en bestemt radius baseret på data for længdegrad og breddegrad.</span><span class="sxs-lookup"><span data-stu-id="04896-118">This API can also be used for warehouses in a specific search area or radius, based on longitude and latitude data.</span></span>
- <span data-ttu-id="04896-119">**GetEstimatedProductWarehouseAvailability** – Brug denne API til at anmode om lageroplysninger for en vare fra et bestemt lagersted.</span><span class="sxs-lookup"><span data-stu-id="04896-119">**GetEstimatedProductWarehouseAvailability** – Use this API to request inventory for an item from a specific warehouse.</span></span> <span data-ttu-id="04896-120">Du kan f.eks. bruge den til at få vist lagertilgængelighed i scenarier, der omfatter ordreafhentning.</span><span class="sxs-lookup"><span data-stu-id="04896-120">For example, you can use it to show inventory availability in scenarios that involve order pickup.</span></span>

> [!NOTE]
> <span data-ttu-id="04896-121">Disse API'er erstatter API'erne **GetProductAvailabilities** og **GetAvailableInventoryNearby** i Dynamics 365 Retail, version 10.0.7 og tidligere.</span><span class="sxs-lookup"><span data-stu-id="04896-121">These APIs replace the **GetProductAvailabilities** and **GetAvailableInventoryNearby** APIs in Dynamics 365 Retail version 10.0.7 and earlier.</span></span>

<span data-ttu-id="04896-122">Begge API'er henter data fra Commerce-serveren og giver en forkalkulation af det disponible lager for en bestemt kombination af et produkt eller en produktvariant og et lagersted.</span><span class="sxs-lookup"><span data-stu-id="04896-122">Both APIs fetch data from the Commerce server and provide an estimate of on-hand inventory for a specific combination of a product or product variant and a warehouse.</span></span> <span data-ttu-id="04896-123">Selvom andre API'er, der er tilgængelige på Commerce-serveren, kan gå direkte til Commerce Headquarters for at hente disponible mængder for produkter, anbefales det ikke, at de bruges i et e-Commerce-miljø på grund af potentielle problemer med ydeevnen og relaterede virkninger, som disse hyppige anmodninger kan have på dine Commerce Headquarters-servere.</span><span class="sxs-lookup"><span data-stu-id="04896-123">Although other APIs that are available on the Commerce server can go directly to Commerce Headquarters to fetch on-hand quantities for products, we don't recommend that they be used in an e-Commerce environment because of potential performance issues and the related impact that these frequent requests can have on your Commerce Headquarters servers.</span></span> <span data-ttu-id="04896-124">Hvis det disponible lager beregnes via Commerce-serveren, er det mere sandsynligt, at beregningen omfatter den lagerbeholdning, der blev solgt i seneste e-Commerce-transaktioner, som endnu ikke er blevet synkroniseret med Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="04896-124">Additionally, if the on-hand inventory is calculated through the Commerce server, the calculation is more likely to include inventory that was sold in recent e-Commerce transactions that haven't yet been synced to Commerce Headquarters.</span></span> <span data-ttu-id="04896-125">Selvom der måske ikke er oplysninger om disse transaktioner i Commerce Headquarters, har Commerce-serveren og kanaldatabasen dataene.</span><span class="sxs-lookup"><span data-stu-id="04896-125">Although Commerce Headquarters might not have information about these transactions, the Commerce server and channel database have the data.</span></span> <span data-ttu-id="04896-126">Dataene vil derfor blive indregnet i og kan hjælpe med at give et mere nøjagtigt estimat over det tilgængelige lager for et produkt.</span><span class="sxs-lookup"><span data-stu-id="04896-126">Therefore, the data will be factored in and can help provide a more accurate estimate of a product's available inventory.</span></span>

### <a name="get-started-with-e-commerce-calculated-inventory-availability"></a><span data-ttu-id="04896-127">Introduktion til beregnet lagertilgængelighed i e-Commerce</span><span class="sxs-lookup"><span data-stu-id="04896-127">Get started with e-Commerce calculated inventory availability</span></span>

<span data-ttu-id="04896-128">Før du bruger de to API'er, der er nævnt tidligere, skal du aktivere funktionen **Beregning af optimeret produkttilgængelighed** via arbejdsområdet **Funktionsstyring** i Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="04896-128">Before you use the two APIs that were mentioned earlier, you must enable the **Optimized product availability calculation** feature through the **Feature management** workspace in Commerce Headquarters.</span></span>

<span data-ttu-id="04896-129">Før API'erne kan beregne det bedst mulige estimat over lagertilgængelighed for en vare, skal et periodisk øjebliksbillede af lagertilgængeligheden fra Commerce Headquarters behandles og sendes til den kanaldatabase, som e-Commerce Scale Unit bruger.</span><span class="sxs-lookup"><span data-stu-id="04896-129">Before the APIs can calculate the best estimate of inventory availability for an item, a periodic snapshot of inventory availability from Commerce Headquarters must be processed and sent to the channel database that the e-Commerce Commerce Scale Unit uses.</span></span> <span data-ttu-id="04896-130">Øjebliksbilledet repræsenterer de oplysninger, som Commerce Headquarters har om lagertilgængeligheden for en bestemt kombination af et produkt eller en produktvariant og et lagersted.</span><span class="sxs-lookup"><span data-stu-id="04896-130">The snapshot represents the information that Commerce Headquarters has about inventory availability for a specific combination of a product or product variant and a warehouse.</span></span> <span data-ttu-id="04896-131">Det kan indeholde lagerreguleringer eller -bevægelser, der er forårsaget af lagerkvitteringer eller forsendelser eller andre processer, der udføres i Commerce Headquarters, og som e-Commerce-kanalen kun har oplysninger om på grund af synkroniseringsprocessen.</span><span class="sxs-lookup"><span data-stu-id="04896-131">It can include inventory adjustments or movements that are caused by inventory receipts, or by shipments or other processes that are performed in Commerce Headquarters and that the e-Commerce channel has information about only because of the synchronization process.</span></span>

<span data-ttu-id="04896-132">Det øjebliksbillede af databasen, som jobbet **Produkttilgængelighed** opretter, beregner kun de lagertransaktioner, der er behandlet og bogført i Commerce Headquarters på det tidspunkt, hvor øjebliksbilledet blev taget.</span><span class="sxs-lookup"><span data-stu-id="04896-132">The database snapshot that the **Product availability** job creates calculates only the inventory transactions that were processed and posted in Commerce Headquarters at the time when the snapshot was taken.</span></span> <span data-ttu-id="04896-133">Hvis lageret for et produkt blev solgt i en butiks lagersted via cash-and-carry eller et asynkront kundeordresalg i POS-programmet, vil Commerce Headquarters ikke omgående få oplysninger om den relaterede lagerafgangstransaktion for salget.</span><span class="sxs-lookup"><span data-stu-id="04896-133">If inventory was sold for a product in a store warehouse through a cash-and-carry or asynchronous customer order sale in the POS application, Commerce Headquarters won't immediately have information about the related inventory issue transaction for the sale.</span></span> <span data-ttu-id="04896-134">Det vil først have oplysninger om det lager, der sælges for disse typer butikssalg, efter P-jobbet overfører den relaterede transaktion fra butikkens kanaldatabase til Commerce Headquarters, og den relaterede salgsordre oprettes via bogføring eller sivende feedbaseret bogføring.</span><span class="sxs-lookup"><span data-stu-id="04896-134">It will have information about the inventory that is sold for these types of store sales only after the P-job uploads the related transaction from the store's channel database into Commerce Headquarters and the related sales order is created through statement posting or the trickle feed posting processes.</span></span> <span data-ttu-id="04896-135">Processen med at oprette ordren i Commerce Headquarters opretter de relaterede lagertransaktioner.</span><span class="sxs-lookup"><span data-stu-id="04896-135">The process of creating the order in Commerce Headquarters creates the related inventory transactions.</span></span> <span data-ttu-id="04896-136">For så vidt angår e-Commerce-kanalordrer indeholder Commerce Headquarters kun oplysninger om lagertransaktionerne, når transaktionerne er sendt til Commerce Headquarters via P-jobbet, og processen til synkronisering af ordren er fuldført.</span><span class="sxs-lookup"><span data-stu-id="04896-136">For e-Commerce channel orders, Commerce Headquarters has information about the inventory transactions only after the transactions are sent to Commerce Headquarters through the P-job and the order synchronization process is completed.</span></span> <span data-ttu-id="04896-137">Det er derfor vigtigt, at du forstår, at den værdi for lagerøjebliksbilledet, der vises i jobbet **Produkttilgængelighed**, muligvis ikke er 100 % nøjagtig i realtid på grund af den konstante salgsbehandling, der opstår på tværs af distribuerede servere.</span><span class="sxs-lookup"><span data-stu-id="04896-137">Therefore, it's important that you understand that the inventory snapshot value that is provided in the **Product availability** job might not be 100-percent accurate in real time because of the constant sales processing that occurs across distributed servers.</span></span>

<span data-ttu-id="04896-138">Hvis du vil tage et øjebliksbillede af lageret i Commerce Headquarters, skal du følge disse trin.</span><span class="sxs-lookup"><span data-stu-id="04896-138">To take a snapshot of inventory in Commerce Headquarters, follow these steps.</span></span>

1. <span data-ttu-id="04896-139">Gå til **Retail og Commerce \> Retail og Commerce IT \> Produkter og lager \> Produkttilgængelighed**.</span><span class="sxs-lookup"><span data-stu-id="04896-139">Go to **Retail and Commerce \> Retail and Commerce IT \> Products and inventory \> Product availability**.</span></span>
1. <span data-ttu-id="04896-140">Vælg **OK** for at køre jobbet **Produkttilgængelighed**.</span><span class="sxs-lookup"><span data-stu-id="04896-140">Select **OK** to run the **Product availability** job.</span></span> <span data-ttu-id="04896-141">Du kan også planlægge dette job, så det køres i en batch.</span><span class="sxs-lookup"><span data-stu-id="04896-141">You can also schedule this job so that it's run in a batch.</span></span>

<span data-ttu-id="04896-142">Når jobbet **Produkttilgængelighed** er kørt færdigt, skal de data, der blev registreret, sendes til e-Commerce-kanalens databaser, så det seneste lager øjebliksbillede for lageret i Commerce Headquarters kan tages i betragtning i forbindelse med beregningen af den forkalkulerede disponible lagerbeholdning.</span><span class="sxs-lookup"><span data-stu-id="04896-142">After the **Product availability** job has finished running, the data that was captured must be pushed to the e-Commerce channel databases, so that the latest Commerce Headquarters inventory snapshot can be considered in the calculation of estimated on-hand inventory.</span></span>

1. <span data-ttu-id="04896-143">Gå til **Retail og Commerce \> Retail og Commerce IT \> Distributionsplan**.</span><span class="sxs-lookup"><span data-stu-id="04896-143">Go to **Retail and Commerce \> Retail and Commerce IT \> Distribution schedule**.</span></span>
1. <span data-ttu-id="04896-144">Kør jobbet **1130** (**Produkttilgængelighed**) for at synkronisere de øjebliksdata, som jobbet **Produkttilgængelighed** oprettede fra Commerce Headquarters til dine kanaldatabaser.</span><span class="sxs-lookup"><span data-stu-id="04896-144">Run the **1130** (**Product availability**) job to sync the snapshot data that the **Product availability** job created from Commerce Headquarters to your channel databases.</span></span>

<span data-ttu-id="04896-145">Når der anmodes om lagertilgængelighed fra API'erne **GetEstimatedAvailability** eller **GetEstimatedProductWarehouseAvailability**, køres der en beregning for at forsøge at få det bedst mulige estimat over produktets lageret.</span><span class="sxs-lookup"><span data-stu-id="04896-145">When inventory availability is requested from the **GetEstimatedAvailability** or **GetEstimatedProductWarehouseAvailability** API, a calculation is run to try to get the best possible estimate of inventory for the product.</span></span> <span data-ttu-id="04896-146">Beregningen refererer til alle kundeordrer, der findes i kanaldatabasen, men som ikke var medtaget i de øjebliksdata, som 1130-jobbet angav.</span><span class="sxs-lookup"><span data-stu-id="04896-146">The calculation references any e-Commerce customer orders that are in the channel database but that weren't included in the snapshot data that the 1130 job provided.</span></span> <span data-ttu-id="04896-147">Denne logik udføres ved at spore den seneste behandlede lagertransaktion fra Commerce Headquarters og sammenligne den med transaktionerne i kanaldatabasen.</span><span class="sxs-lookup"><span data-stu-id="04896-147">This logic is performed by tracking the last processed inventory transaction from Commerce Headquarters and comparing it with the transactions in the channel database.</span></span> <span data-ttu-id="04896-148">Det giver en basislinje for beregningslogikken for kanalsiden, så de ekstra lagerbevægelser, der forekom for kundeordresalgstransaktioner i e-Commerce-kanaldatabasen, kan medtages i den estimerede lagerværdi, som API 'et tilvejebringer.</span><span class="sxs-lookup"><span data-stu-id="04896-148">It provides a baseline for the channel-side calculation logic, so that the additional inventory movements that occurred for customer order sales transactions in the e-Commerce channel database can be factored into the estimated inventory value that the API provides.</span></span>

<span data-ttu-id="04896-149">I beregningslogikken for kanalsiden returneres en estimeret værdi for den fysiske tilgængelighed og en samlet tilgængelighedsværdi for det anmodede produkt og lagersted.</span><span class="sxs-lookup"><span data-stu-id="04896-149">The channel-side calculation logic returns an estimated physically available value and a total available value for the requested product and warehouse.</span></span> <span data-ttu-id="04896-150">Værdierne kan vises på dit e-Commerce-websted, hvis du ønsker det, eller de kan bruges til at udløse en anden forretningslogik på dit e-Commerce-websted.</span><span class="sxs-lookup"><span data-stu-id="04896-150">The values can be shown on your e-Commerce site if you want, or they can be used to trigger other business logic on your e-Commerce site.</span></span> <span data-ttu-id="04896-151">Du kan f.eks. vise en "uden for lager"-meddelelse i stedet for det faktiske disponible antal, som API'et har videregivet.</span><span class="sxs-lookup"><span data-stu-id="04896-151">For example, you can show an "out of stock" message instead of the actual on-hand quantity that the API passed.</span></span>

<span data-ttu-id="04896-152">Den beregningslogik, som API'erne for e-Commerce-kanalsiden anvender i den forkalkulerede lagerværdi, kan kun evaluere lageret ud fra de kundeordrer, der er oprettet i kanaldatabasen, men som endnu ikke er blevet synkroniseret og bogført i Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="04896-152">The calculation logic that the channel-side e-Commerce APIs use for the estimated inventory value can evaluate inventory based only on customer orders that have been created in the channel database but that haven't yet been synced and posted in Commerce Headquarters.</span></span> <span data-ttu-id="04896-153">Hvis kanaldatabasen også indeholder transaktionsdata til cash-and-carry-salg for butiksspecifikke lagersteder, indregnes cash-and-carry-salgene ikke i kanalsiden for e-Commerce-beregningen for de pågældende lagersteder.</span><span class="sxs-lookup"><span data-stu-id="04896-153">If your channel database also contains transactional data for cash-and-carry sales for store-specific warehouses, the cash-and-carry sales aren't factored into the channel-side e-Commerce calculation for those warehouses.</span></span>

## <a name="configure-the-inventory-lookup-operation-in-the-pos-channel"></a><span data-ttu-id="04896-154">Konfigurer handlingen lagersøgning i POS-kanalen</span><span class="sxs-lookup"><span data-stu-id="04896-154">Configure the inventory lookup operation in the POS channel</span></span>

<span data-ttu-id="04896-155">I Retail version 10.0.9 og tidligere har handlingen **Lagersøgning** fra POS brugt et realtids servicekald til Commerce Headquarters til at hente lageroplysninger om det valgte produkt for både brugerens aktuelle butik og eventuelle andre butikker, der er konfigureret i opfyldelsesgruppen, som en del af kanalkonfigurationen for butikken.</span><span class="sxs-lookup"><span data-stu-id="04896-155">In Retail version 10.0.9 and earlier, the **Inventory lookup** operation from POS used a real-time service call to Commerce Headquarters to get inventory information for the selected product, for both the user's current store and any other stores that are configured for the fulfillment group as part of the channel configuration for the store.</span></span> <span data-ttu-id="04896-156">I Commerce version 10.0.10 og nyere kan du deaktivere realtids servicekald til Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="04896-156">In Commerce version 10.0.10 and later, you can turn off real-time service calls to Commerce Headquarters.</span></span> <span data-ttu-id="04896-157">Du kan i stedet bruge beregningen på kanalsiden på Commerce-serveren til at bestemme det disponible lager, der skal være fysisk tilgængeligt for butikken og de andre placeringer, der er defineret i opfyldelsesgruppen.</span><span class="sxs-lookup"><span data-stu-id="04896-157">Instead, you can use channel-side calculation on the Commerce server to determine the on-hand inventory that is physically available for the store and any other locations that are defined in the fulfillment group.</span></span> <span data-ttu-id="04896-158">Denne kanalberegnede lagerkonfiguration er også nyttig for placeringer, hvor der er upålidelig forbindelse til internettet, da du ikke behøver at være online for at hente lagersøgninger fra Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="04896-158">This channel-calculated inventory configuration is also useful for locations where internet connectivity is unreliable, because you don't have to be online to get inventory lookups from Commerce Headquarters.</span></span>

<span data-ttu-id="04896-159">Når kanalsideberegningen er korrekt konfigureret og administreret, kan det give et mere pålideligt estimat over det aktuelle butikslager, fordi det bruger de transaktionsdata, der findes i Commerce-kanaldatabasen, men som Commerce Headquarters måske endnu ikke indeholder oplysninger om.</span><span class="sxs-lookup"><span data-stu-id="04896-159">When channel-side calculation is correctly configured and managed, it can provide a more reliable estimate of the current store inventory, because it uses the transactional data that is in the Commerce channel database but that Commerce Headquarters might not yet have information about.</span></span> <span data-ttu-id="04896-160">Hvis du f.eks. bruger det eksisterende real-time servicekald til at foretage lagersøgninger i POS, har Commerce Headquarters sandsynligvis ikke nogen oplysninger om et cash-and-carry-salg af et produkt, som netop er foretaget.</span><span class="sxs-lookup"><span data-stu-id="04896-160">For example, if you use the existing real-time service call for inventory lookups in POS, Commerce Headquarters probably won't yet have information about a cash-and-carry sale that just occurred for a product.</span></span> <span data-ttu-id="04896-161">Derfor vil den disponible lagerværdi, som Commerce Headquarters returnerer for det pågældende produkt, formentlig overstige butikkens faktiske disponible lager med én enhed.</span><span class="sxs-lookup"><span data-stu-id="04896-161">Therefore, the on-hand inventory value that Commerce Headquarters returns for that product will probably exceed the store's actual on-hand inventory by one unit.</span></span> <span data-ttu-id="04896-162">Men hvis du bruger kanalsideberegningen, kan cash-and-carry-salg medtages i beregningen og trækkes fra den disponible værdi, der vises.</span><span class="sxs-lookup"><span data-stu-id="04896-162">However, if you use channel-side calculation, the cash-and-carry sale can be factored into the calculation and deducted from the on-hand value that is shown.</span></span> <span data-ttu-id="04896-163">Selvom de værdier, som både kanalsideberegninger og realtids servicekald tilvejebringer, blot er estimater af det disponible lager, er det meget mere sandsynligt, at den værdi, som kanalsideberegningen giver, er et nøjagtigt billede af den aktuelle butik.</span><span class="sxs-lookup"><span data-stu-id="04896-163">Although the values that both the channel-side calculation and the real-time service call provide are only estimates of on-hand inventory, the value that the channel-side calculation provides is much more likely to be accurate for the current store.</span></span>

### <a name="get-started-with-pos-channel-side-calculated-inventory-availability"></a><span data-ttu-id="04896-164">Introduktion til beregnet lagertilgængelighed på en POS-kanalside</span><span class="sxs-lookup"><span data-stu-id="04896-164">Get started with POS channel-side calculated inventory availability</span></span>

<span data-ttu-id="04896-165">Hvis du vil bruge beregningslogikken for kanalsiden og deaktivere realtidstjenesteopkald for lageropslag fra POS-programmet, skal du først aktivere funktionen **Beregning af optimeret produkttilgængelighed** via arbejdsområdet **Funktionsstyring** i Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="04896-165">To use the channel-side calculation logic and turn off real-time service calls for inventory lookups from the POS application, you must first enable the **Optimized product availability calculation** feature through the **Feature management** workspace in Commerce Headquarters.</span></span> <span data-ttu-id="04896-166">Ud over at aktivere funktionen skal du foretage ændringer af **funktionalitetsprofilen**.</span><span class="sxs-lookup"><span data-stu-id="04896-166">In addition to enabling the feature, you must make changes to the **Functionality profile**.</span></span>

<span data-ttu-id="04896-167">Benyt følgende fremgangsmåde for at ændre **funktionalitetsprofilen**:</span><span class="sxs-lookup"><span data-stu-id="04896-167">To change the **Functionality profile**, follow these steps:</span></span>

1. <span data-ttu-id="04896-168">Gå til **Retail og Commerce \> Konfiguration af kanal \> POS-opsætning \> POS-profiler \> Funktionalitetsprofiler**.</span><span class="sxs-lookup"><span data-stu-id="04896-168">Go to **Retail and Commerce \> Channel setup \> POS setup \> POS profiles \> Functionality profiles**.</span></span>
1. <span data-ttu-id="04896-169">Vælg en funktionalitetsprofil.</span><span class="sxs-lookup"><span data-stu-id="04896-169">Select a functionality profile.</span></span>
1. <span data-ttu-id="04896-170">I oversigtspanelet **Funktioner** i sektionen **Beregning af disponibelt lager** skal du ændre værdien i feltet **Metode til beregning af disponibelt lager** fra **Realtidstjeneste** til **Kanal**.</span><span class="sxs-lookup"><span data-stu-id="04896-170">On the **Functions** FastTab, in the **Invent availability calculation** section, change the value of the **Invent availability calculation mode** field from **Real time service** to **Channel**.</span></span> <span data-ttu-id="04896-171">Alle funktionalitetsprofiler anvender som standard realtidstjenestekald.</span><span class="sxs-lookup"><span data-stu-id="04896-171">By default, all functionality profiles use real-time service calls.</span></span> <span data-ttu-id="04896-172">Du skal derfor ændre værdien i dette felt, hvis du vil bruge kanalsidens beregningslogik.</span><span class="sxs-lookup"><span data-stu-id="04896-172">Therefore, you must change the value of this field if you want to use channel-side calculation logic.</span></span> <span data-ttu-id="04896-173">Alle de detailbutikker, der er kædet sammen med den valgte funktionalitetsprofil, påvirkes af ændringen.</span><span class="sxs-lookup"><span data-stu-id="04896-173">Every retail store that is linked to the selected functionality profile will be affected by this change.</span></span>

<span data-ttu-id="04896-174">Du skal derefter synkronisere ændringerne af kanalen ved hjælp af processen for distributionsplanlægning ved at udføre følgende trin:</span><span class="sxs-lookup"><span data-stu-id="04896-174">You must then sync the changes to the channel through the distribution schedule process by performing the following steps:</span></span>

1. <span data-ttu-id="04896-175">Gå til **Retail og Commerce \> Retail og Commerce IT \> Distributionsplan**.</span><span class="sxs-lookup"><span data-stu-id="04896-175">Go to **Retail and Commerce \> Retail and Commerce IT \> Distribution schedule**.</span></span>
1. <span data-ttu-id="04896-176">Kør jobbet **1070** (**Kanalkonfiguration**).</span><span class="sxs-lookup"><span data-stu-id="04896-176">Run the **1070** (**Channel configuration**) job.</span></span>

<span data-ttu-id="04896-177">Når konfigurationen er fuldført, bruger de oplysninger, der er til rådighed for tilgængeligheden på det fysiske lager, ikke længere et realtids servicekald, når en bruger i POS-programmer anvender handlingen **Lagersøgning** (standard- og matrixvisninger).</span><span class="sxs-lookup"><span data-stu-id="04896-177">After the configuration is completed, the information that is provided about physically available inventory no longer uses a real-time service call when a user in the POS application uses the **Inventory lookup** operation (standard and matrix views).</span></span> <span data-ttu-id="04896-178">I stedet beregnes data om det fysisk disponible lager for den aktuelle butik og alle butikker i opfyldelsesgruppen på grundlag af det sidst kendte øjebliksbillede, der blev leveret til kanaldatabasen fra Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="04896-178">Instead, data about physically available inventory for the current store and all the stores in the fulfillment group is calculated based on the last-known snapshot that was delivered to the channel database from Commerce Headquarters.</span></span> <span data-ttu-id="04896-179">Værdien i øjebliksbilledet bestemmes endvidere af kanalsideberegningen for at justere den fysisk tilgængelighedsværdi og er baseret på de yderligere salgs- eller returneringstransaktioner, der er foretaget for det valgte produkt i kanaldatabasen, og som ikke var medtaget i det sidste synkroniserede øjebliksbillede fra 1130-jobbet.</span><span class="sxs-lookup"><span data-stu-id="04896-179">The snapshot value is further refined by the channel-side calculation to adjust the physically available value, based on additional sales or return transactions that exist for the selected product in the channel database that were not included in the last synchronized snapshot from the 1130 job.</span></span> <span data-ttu-id="04896-180">Hvis kanaldatabasen ikke indeholder transaktionsdata for nogle af lagerstederne eller butikkerne i opfyldelsesgruppen, indeholder den ikke yderligere transaktioner, som kan tages i betragtning i forbindelse med en genberegning af værdien.</span><span class="sxs-lookup"><span data-stu-id="04896-180">If the channel database doesn't contain transactional data for any of the warehouses or stores in the fulfillment group, it contains no additional transactions that can be factored into a recalculation of the value.</span></span> <span data-ttu-id="04896-181">Det bedste estimat over det disponible lager, der kan vises for de pågældende lagersteder eller butikker, er derfor data fra det sidst kendte øjebliksbillede af Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="04896-181">Therefore, the best estimate of on-hand inventory that can be shown for those warehouses or stores is the data from the last-known Commerce Headquarters snapshot.</span></span>

<span data-ttu-id="04896-182">POS' skærmbillederne **Opfyldelse af ordre** bruger også kanalsideberegningen til at vise det disponible lager for varer, når en ordreopfyldelseslinje vælges, og en bruger får vist panelet **Detaljer** for den valgte vare.</span><span class="sxs-lookup"><span data-stu-id="04896-182">The **Order fulfillment** screens of POS also leverage the channel side calculation to show on-hand inventory for items when an order fulfillment line is selected and a user views the **Details** panel for on-hand inventory for the selected item.</span></span>

## <a name="optimize-your-inventory-data"></a><span data-ttu-id="04896-183">Optimer lagerdataene</span><span class="sxs-lookup"><span data-stu-id="04896-183">Optimize your inventory data</span></span>

<span data-ttu-id="04896-184">For at sikre det bedst mulige estimat over lageret, er det vigtigt, at du bruger følgende Commerce-batchjob og kører dem ofte:</span><span class="sxs-lookup"><span data-stu-id="04896-184">To ensure the best possible estimate of inventory, it's critical that you use the following Commerce batch jobs and run them frequently:</span></span>

- <span data-ttu-id="04896-185">**P-job** – P-jobbet findes på siden **Distributionsplaner** og bør køres ofte.</span><span class="sxs-lookup"><span data-stu-id="04896-185">**P-job** – The P-job is found on the **Distribution schedules** page and should be run frequently.</span></span> <span data-ttu-id="04896-186">Dette job overfører e-Commerce-ordrer, asynkrone kundeordrer, som er oprettet af POS, samt cash-and-carry-ordrer, som POS har oprettet på baggrund af kanaldatabaserne, til Commerce Headquarters, så de kan behandles yderligere.</span><span class="sxs-lookup"><span data-stu-id="04896-186">This job brings e-Commerce orders, asynchronous customer orders that POS created, and cash-and-carry orders that POS created from the channel databases into Commerce Headquarters, so that they can be processed further.</span></span> <span data-ttu-id="04896-187">Indtil disse data er synkroniseret fra kanalen til Commerce Headquarters, har Commerce Headquarters ingen oplysninger om lagerreguleringer af produkter på de lagersteder, der er resultatet af disse transaktioner.</span><span class="sxs-lookup"><span data-stu-id="04896-187">Until this data is synced from the channel to Commerce Headquarters, Commerce Headquarters has no information about inventory adjustments to products in the warehouses that result from those transactions.</span></span>
- <span data-ttu-id="04896-188">**Synkroniser ordrer** – Dette job behandler de rå transaktionsdata i Commerce Headquarters, som P-jobbet tilvejebringer, og konverterer e-Commerce-transaktioner og asynkrone kundeordretransaktioner til salgsordrer i Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="04896-188">**Synchronize orders** – This job processes the raw transactional data in Commerce Headquarters that the P-job provides and converts e-Commerce and asynchronous customer order transactions into sales orders in Commerce Headquarters.</span></span> <span data-ttu-id="04896-189">Der oprettes ingen lagertransaktioner, før dette job er blevet behandlet, og der er blevet oprettet salgsordrer.</span><span class="sxs-lookup"><span data-stu-id="04896-189">Until this job is processed and the sales orders are created, no inventory transactions are created.</span></span> <span data-ttu-id="04896-190">Det disponible lager i Commerce Headquarters vil derfor ikke tage højde for transaktionerne.</span><span class="sxs-lookup"><span data-stu-id="04896-190">Therefore, on-hand inventory in Commerce Headquarters won't consider the transactions.</span></span>
- <span data-ttu-id="04896-191">**Beregn transaktionsopgørelser i batch** – For så vidt angår cash-and-carry-transaktioner, der oprettes i butikken, sikrer den sivende feedbaseret bogføringsproces, at det lager, der er relateret til salget, opdateres effektivt.</span><span class="sxs-lookup"><span data-stu-id="04896-191">**Calculate transactional statements in batch** – For cash-and-carry transactions that are created in the store, the trickle feed posting process ensures that inventory that is related to the sales is updated efficiently.</span></span> <span data-ttu-id="04896-192">Hvis du vil opnå den mest effektive behandling af lagertransaktioner for cash-and-carry-ordrer, skal du sikre dig, at du konfigurerer dit system til at anvende [sivende feedbaseret bogføring](https://docs.microsoft.com/dynamics365/commerce/trickle-feed).</span><span class="sxs-lookup"><span data-stu-id="04896-192">To get the most efficient processing of inventory transactions for cash-and-carry orders, make sure that you configure your system to use [trickle feed posting](https://docs.microsoft.com/dynamics365/commerce/trickle-feed).</span></span>
- <span data-ttu-id="04896-193">**Bogfør transaktionsopgørelser i batch** – Dette job er også påkrævet ved sivende feedbaseret bogføring.</span><span class="sxs-lookup"><span data-stu-id="04896-193">**Post transactional statements in batch** – This job is also required for trickle feed posting.</span></span> <span data-ttu-id="04896-194">Den følger jobbet **Beregning af transaktionsopgørelser i batch**.</span><span class="sxs-lookup"><span data-stu-id="04896-194">It follows the **Calculate transactional statements in batch** job.</span></span> <span data-ttu-id="04896-195">Dette job bogfører systematisk de beregnede opgørelser, så der oprettes salgsordrer for cash-and-carry-salg i Commerce Headquarters, og Commerce Headquarters mere nøjagtigt kan afspejle butikkens lagerbeholdning.</span><span class="sxs-lookup"><span data-stu-id="04896-195">This job systematically posts the calculated statements, so that sales orders for cash-and-carry sales are created in Commerce Headquarters and Commerce Headquarters more accurately reflects your store's inventory.</span></span>
- <span data-ttu-id="04896-196">**Produkttilgængelighed** – Dette job opretter øjebliksbilledet af lageret fra Commerce Headquarters.</span><span class="sxs-lookup"><span data-stu-id="04896-196">**Product availability** – This job creates the snapshot of inventory from Commerce Headquarters.</span></span>
- <span data-ttu-id="04896-197">**1130 (Produkttilgængelighed)** – Dette job kan findes på siden **Distributionsplaner** og bør køres umiddelbart efter jobbet **Produkttilgængelighed**.</span><span class="sxs-lookup"><span data-stu-id="04896-197">**1130 (Product availability)** – This job is found on the **Distribution schedules** page and should be run immediately after the **Product availability** job.</span></span> <span data-ttu-id="04896-198">Dette job viderefører øjebliksdataene for lageret fra Commerce Headquarters til kanaldatabaserne.</span><span class="sxs-lookup"><span data-stu-id="04896-198">This job transports the inventory snapshot data from Commerce Headquarters to the channel databases.</span></span>

<span data-ttu-id="04896-199">Det anbefales, at du ikke kører disse batchjob for ofte (med få minutters mellemrum).</span><span class="sxs-lookup"><span data-stu-id="04896-199">It's recommended that you don't run those batch jobs too frequently (every few minutes).</span></span> <span data-ttu-id="04896-200">Hyppige kørsler vil overbelaste Commerce Headquarters (hovedkontor) og kan påvirke ydeevnen.</span><span class="sxs-lookup"><span data-stu-id="04896-200">Frequent runs will overload Commerce headquarters (HQ) and can potentially impact performance.</span></span> <span data-ttu-id="04896-201">Generelt er det en god ide at køre produkttilgængeligheden og 1130 job hver time, planlægge P-job, synkronisere ordrer og udføre sivende feedbaseret bogføring med samme eller højere frekvens.</span><span class="sxs-lookup"><span data-stu-id="04896-201">In general, it's good practice to run product availability and 1130 jobs on an hourly basis, and schedule P-job, synchronize orders, and trickle feed posting-related jobs with the same or higher frequency.</span></span>

> [!NOTE]
> <span data-ttu-id="04896-202">Af hensyn til ydeevnen bruger beregningen en cache til at angive, om der er forløbet nok tid til at kunne begrunde at køre beregningslogikken igen, når der anvendes kanalsideberegninger til at beregne lagertilgængelighed til at foretage en anmodning om varetilgængelighed ved hjælp af beregninger af e-Commerce-API'erne eller den nye POS-kanalsidelagerlogik.</span><span class="sxs-lookup"><span data-stu-id="04896-202">For performance reasons, when channel-side inventory availability calculations are used to make an inventory availability request using the e-Commerce API's or the new POS channel-side inventory logic, the calculation uses a cache to determine whether enough time has passed to justify running the calculation logic again.</span></span> <span data-ttu-id="04896-203">Standardcachen er angivet til 60 sekunder.</span><span class="sxs-lookup"><span data-stu-id="04896-203">The default cache is set to 60 seconds.</span></span> <span data-ttu-id="04896-204">Du har f.eks. slået kanalsideberegningen til for din butik og har fået vist det disponible lager for et produkt på siden **Lagersøgning**.</span><span class="sxs-lookup"><span data-stu-id="04896-204">For example, you turned on channel-side calculation for your store and viewed the on-hand inventory for a product on the **Inventory lookup** page.</span></span> <span data-ttu-id="04896-205">Hvis der derefter sælges en enhed af produktet, vil siden **Lagersøgning** ikke vise det reducerede lager, før cachen er blevet ryddet.</span><span class="sxs-lookup"><span data-stu-id="04896-205">If one unit of the product is then sold, the **Inventory lookup** page won't show the reduced inventory until the cache has been cleared.</span></span> <span data-ttu-id="04896-206">Når brugere har bogført transaktioner i POS, bør de vente 60 sekunder, før de bekræfter, at det disponible lager er blevet reduceret.</span><span class="sxs-lookup"><span data-stu-id="04896-206">After users post transactions in POS, they should wait 60 seconds before they verify that the on-hand inventory has been reduced.</span></span>

<span data-ttu-id="04896-207">Hvis dit forretningsscenarie kræver en mindre cacheperiode, skal du kontakte produktsupportmedarbejderen for at få hjælp.</span><span class="sxs-lookup"><span data-stu-id="04896-207">If your business scenario requires a smaller cache time, contact your product support representative for help.</span></span>
