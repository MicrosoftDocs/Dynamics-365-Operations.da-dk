---
title: Konsistenskontrol af detailtransaktion
description: Dette emne beskriver funktionen konsistenskontrol af transaktion i Dynamics 365 Commerce.
author: josaw1
ms.date: 10/07/2020
ms.topic: index-page
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.custom: ''
ms.assetid: ed0f77f7-3609-4330-bebd-ca3134575216
ms.search.region: global
ms.search.industry: Retail
ms.author: josaw
ms.search.validFrom: 2019-01-15
ms.dyn365.ops.version: 10
ms.openlocfilehash: 9a4f03d8cf6696b7e449448704e5360f2ef585b7
ms.sourcegitcommit: 3cdc42346bb653c13ab33a7142dbb7969f1f6dda
ms.translationtype: HT
ms.contentlocale: da-DK
ms.lasthandoff: 03/31/2021
ms.locfileid: "5803699"
---
# <a name="retail-transaction-consistency-checker"></a><span data-ttu-id="d10d0-103">Konsistenskontrol af detailtransaktion</span><span class="sxs-lookup"><span data-stu-id="d10d0-103">Retail transaction consistency checker</span></span>

[!include [banner](includes/banner.md)]

<span data-ttu-id="d10d0-104">Dette emne beskriver funktionen konsistenskontrol af transaktion i Microsoft Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="d10d0-104">This topic describes the transaction consistency checker functionality in Microsoft Dynamics 365 Commerce.</span></span> <span data-ttu-id="d10d0-105">Konsistenskontrollen identificerer og isolerer inkonsistente transaktioner, før de hentes af processen til bogføring af opgørelsen.</span><span class="sxs-lookup"><span data-stu-id="d10d0-105">The consistency checker identifies and isolates inconsistent transactions before they are picked up by the statement posting process.</span></span>

<span data-ttu-id="d10d0-106">Når en opgørelse er bogført, kan bogføringen mislykkes på grund af inkonsistente data i Commerce-transaktionstabellerne.</span><span class="sxs-lookup"><span data-stu-id="d10d0-106">When a statement is posted, posting can fail due to inconsistent data in the commerce transaction tables.</span></span> <span data-ttu-id="d10d0-107">Dataproblemet kan skyldes uforudsete problemer i POS-programmet, eller at transaktioner blev importeret forkert fra tredjeparts-POS-systemer.</span><span class="sxs-lookup"><span data-stu-id="d10d0-107">The data issue may be caused by unforeseen issues in the point of sale (POS) application, or if transactions were incorrectly imported from third-party POS systems.</span></span> <span data-ttu-id="d10d0-108">Eksempler på, hvordan denne inkonsistens kan vise sig, omfatter:</span><span class="sxs-lookup"><span data-stu-id="d10d0-108">Examples of how these inconsistencies may appear include:</span></span> 

- <span data-ttu-id="d10d0-109">Totalen for transaktionen i hovedtabellen stemmer ikke overens med transaktionstotalen på linjerne.</span><span class="sxs-lookup"><span data-stu-id="d10d0-109">The transaction total on the header table does not match the transaction total on the lines.</span></span>
- <span data-ttu-id="d10d0-110">Linjeantallet i hovedtabellen stemmer ikke overens med antallet af linjer i transaktionstabellen.</span><span class="sxs-lookup"><span data-stu-id="d10d0-110">The line count on the header table does not match with the number of lines in the transaction table.</span></span>
- <span data-ttu-id="d10d0-111">Moms i hovedtabellen stemmer ikke overens med momsbeløb på linjerne.</span><span class="sxs-lookup"><span data-stu-id="d10d0-111">Taxes on the header table do not match the tax amount on the lines.</span></span> 

<span data-ttu-id="d10d0-112">Når inkonsistente transaktioner hentes af processen til bogføring af opgørelsen, oprettes der inkonsekvente salgsfakturaer og betalingskladder, og hele bogføringsprocessen for opgørelsen mislykkes derfor.</span><span class="sxs-lookup"><span data-stu-id="d10d0-112">When inconsistent transactions are picked up by the statement posting process, inconsistent sales invoices and payment journals are created, and the entire statement posting process fails as a result.</span></span> <span data-ttu-id="d10d0-113">Gendannelsen af opgørelserne fra en sådan tilstand omfatter komplekse rettelser af data på tværs af flere transaktionstabeller.</span><span class="sxs-lookup"><span data-stu-id="d10d0-113">Recovering the statements from such a state involves complex data fixes across multiple transaction tables.</span></span> <span data-ttu-id="d10d0-114">Konsistenskontrollen af transaktioner forhindrer sådanne problemer.</span><span class="sxs-lookup"><span data-stu-id="d10d0-114">The transaction consistency checker prevents such issues.</span></span>

<span data-ttu-id="d10d0-115">I følgende diagram illustreres bogføringsprocessen med konsistenskontrollen af transaktioner.</span><span class="sxs-lookup"><span data-stu-id="d10d0-115">The following chart illustrates the posting process with the transaction consistency checker.</span></span>

<span data-ttu-id="d10d0-116">![Processen til bogføring af opgørelse med konsistenskontrol af transaktioner](./media/validchecker.png "Processen til bogføring af opgørelse med konsistenskontrol af detailtransaktioner")</span><span class="sxs-lookup"><span data-stu-id="d10d0-116">![Statement posting process with transaction consistency checker](./media/validchecker.png "Statement posting process with retail transaction consistency checker")</span></span>

<span data-ttu-id="d10d0-117">Batchprocessen **Valider butiksposteringer** kontrollerer konsistensen af Commerce-transaktionstabellerne i følgende scenarier.</span><span class="sxs-lookup"><span data-stu-id="d10d0-117">The **Validate store transactions** batch process checks the consistency of the commerce transaction tables for the following scenarios.</span></span>

- <span data-ttu-id="d10d0-118">**Debitorkonto** – validerer, at debitorkontoen i transaktionstabellerne findes i debitormasteren i hovedkontoret.</span><span class="sxs-lookup"><span data-stu-id="d10d0-118">**Customer account** – Validates that the customer account in the transaction tables exists in the HQ customer master.</span></span>
- <span data-ttu-id="d10d0-119">**Linjetæller** – validerer, at antallet af linjer, som er angivet i transaktionshovedtabellen, svarer til antallet af linjer i salgstransaktionstabellerne.</span><span class="sxs-lookup"><span data-stu-id="d10d0-119">**Line count** – Validates that the number of lines, as captured on the transaction header table, matches the number of lines in the sales transaction tables.</span></span>
- <span data-ttu-id="d10d0-120">**Pris inkl. moms** – validerer, at parameteren **prisen inkluderer moms** er konsistent på tværs af posteringslinjer, og prisen på salgslinjen er i overensstemmelse med prisen og omfatter konfiguration af moms og se-nummer.</span><span class="sxs-lookup"><span data-stu-id="d10d0-120">**Price includes tax** – Validates that the **Price includes tax** parameter is consistent across transaction lines and the price on the sales line is in accordance with price includes tax and tax exempt configuration.</span></span>
- <span data-ttu-id="d10d0-121">**Betalingsbeløb** – validerer, at betalingsposterne svarer til betalingsbeløbet i overskriften, mens den faktor, der er konfigureret til at afrundes i finans, også indregnes.</span><span class="sxs-lookup"><span data-stu-id="d10d0-121">**Payment amount** - Validates that the payment records match the payment amount on the header, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="d10d0-122">**Bruttobeløb** – validerer, at bruttobeløbet i overskriften er summen af nettobeløbene på linjerne plus momsbeløbet, mens den faktor, der er konfigureret til øredifferencer i finans, også indregnes.</span><span class="sxs-lookup"><span data-stu-id="d10d0-122">**Gross amount** – Validates that the gross amount on the header is the sum of the net amounts on the lines plus the tax amount, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="d10d0-123">**Nettobeløb** – validerer, at nettobeløbet i overskriften er summen af nettobeløbene på linjerne, mens den faktor, der er konfigureret til øredifferencer i finans, også indregnes.</span><span class="sxs-lookup"><span data-stu-id="d10d0-123">**Net amount** – Validates that the net amount on the header is the sum of the net amounts on the lines, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="d10d0-124">**Under-/overbetaling** – validerer, at differencen mellem bruttobeløbet i overskriften og betalingsbeløbet ikke overskrider konfigurationen af den maksimalt tilladte underbetaling/overbetaling, mens den faktor, der er konfigureret til øredifferencer i finans, også indregnes.</span><span class="sxs-lookup"><span data-stu-id="d10d0-124">**Under / Over payment** – Validates that the difference between the gross amount on the header and the payment amount doesn't exceed the maximum underpayment/overpayment configuration, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="d10d0-125">**Rabatbeløb** – validerer, at rabatbeløbet på rabattabellerne og rabatbeløbet i tabellerne for detailtransaktionslinjer er konsistente, og at rabatbeløbet i hovedet er summen af rabatbeløbene på linjerne, mens den faktor, der er konfigureret til øredifferencer i finans, også indregnes.</span><span class="sxs-lookup"><span data-stu-id="d10d0-125">**Discount amount** – Validates that the discount amount on the discount tables and the discount amount on the transaction line tables are consistent, and that the discount amount on the header is the sum of the discount amounts on the lines, while also factoring in the configuration for penny rounding in General Ledger.</span></span>
- <span data-ttu-id="d10d0-126">**Linjerabat** – validerer, at linjerabatten på transaktionslinjen er summen af alle linjer i rabattabellen, der svarer til transaktionslinjen.</span><span class="sxs-lookup"><span data-stu-id="d10d0-126">**Line discount** – Validates that the line discount on the transaction line is the sum of all the lines in the discount table that corresponds to the transaction line.</span></span>
- <span data-ttu-id="d10d0-127">**Gavekortvare** – Commerce understøtter ikke returnering af gavekortvarer.</span><span class="sxs-lookup"><span data-stu-id="d10d0-127">**Gift card item** – Commerce doesn't support the return of gift card items.</span></span> <span data-ttu-id="d10d0-128">Saldoen på et gavekort kan dog udbetales kontant. Alle gavekortvarer, der behandles som en returlinje i stedet for en udbetalingslinje, mislykkes i bogføringsprocessen for opgørelsen.</span><span class="sxs-lookup"><span data-stu-id="d10d0-128">However, the balance on a gift card can be cashed out. Any gift card item that is processed as a return line instead of a cash-out line fails the statement posting process.</span></span> <span data-ttu-id="d10d0-129">Valideringsprocessen for gavekortvarer er garanti for, at de eneste returneringslinjer for gavekortvarer i transaktionstabellerne er udbetalingslinjer for gavekort.</span><span class="sxs-lookup"><span data-stu-id="d10d0-129">The validation process for gift card items helps guarantee that the only return gift card line items on the transaction tables are gift card cash-out lines.</span></span>
- <span data-ttu-id="d10d0-130">**Negativ pris** – validerer, at der ikke er nogen negative pristransaktionslinjer.</span><span class="sxs-lookup"><span data-stu-id="d10d0-130">**Negative price** – Validates that there are no negative price transaction lines.</span></span>
- <span data-ttu-id="d10d0-131">**Vare og variant** – validerer, at varer og varianter på transaktionslinjerne findes i masterfilen for vare og variant.</span><span class="sxs-lookup"><span data-stu-id="d10d0-131">**Item & Variant** – Validates that items and variants on the transaction lines exist in the item and variant master file.</span></span>
- <span data-ttu-id="d10d0-132">**Momsbeløb** - validerer, at momsposter svarer til momsbeløbene på linjerne.</span><span class="sxs-lookup"><span data-stu-id="d10d0-132">**Tax amount** - Validates that tax records match the tax amounts on the lines.</span></span>
- <span data-ttu-id="d10d0-133">**Serienummer** - validerer, at serienummeret findes i posteringslinjerne for varer, der styres af serienummer.</span><span class="sxs-lookup"><span data-stu-id="d10d0-133">**Serial number** - Validates that the serial number is present in the transaction lines for items that are controlled by serial number.</span></span>
- <span data-ttu-id="d10d0-134">**Fortegn** - validerer, at fortegnet på antallet og nettobeløbet er det samme i alle posteringslinjerne.</span><span class="sxs-lookup"><span data-stu-id="d10d0-134">**Sign** - Validates that the sign on the quantity and the net amount are the same in all the transaction lines.</span></span>
- <span data-ttu-id="d10d0-135">**Forretningsdato** - validerer, at de økonomiske perioder for alle forretningsdatoerne for transaktionerne er åbne.</span><span class="sxs-lookup"><span data-stu-id="d10d0-135">**Business date** - Validates that the financial periods for all the business dates for the transactions are open.</span></span>
- <span data-ttu-id="d10d0-136">**Gebyrer** – validerer, at overskriften og linjegebyrbeløbet er i overensstemmelse med prisen, inklusive konfigurationen af moms og se-nummer.</span><span class="sxs-lookup"><span data-stu-id="d10d0-136">**Charges** - Validates that the header and line charge amount is in accordance with price, including tax and tax exempt configuration.</span></span>

## <a name="set-up-the-consistency-checker"></a><span data-ttu-id="d10d0-137">Konfigurere konsistenskontrollen</span><span class="sxs-lookup"><span data-stu-id="d10d0-137">Set up the consistency checker</span></span>

<span data-ttu-id="d10d0-138">Konfigurere batchprocessen "Valider butiksposteringer" på **Retail og Commerce \> Retail og Commerce IT \> POS-bogføring** til periodiske kørsler.</span><span class="sxs-lookup"><span data-stu-id="d10d0-138">Configure the "Validate store transactions" batch process, at **Retail and Commerce \> Retail and Commerce IT \> POS posting**, for periodic runs.</span></span> <span data-ttu-id="d10d0-139">Batchjobbet kan planlægges ud fra butikkens organisationshierarki på samme måde som processerne "Beregn opgørelser i batch" og "Bogfør opgørelse i batch" er konfigureret.</span><span class="sxs-lookup"><span data-stu-id="d10d0-139">The batch job can be scheduled based on store organization hierarchy, similar to how the "Calculate statement in batch" and "Post statement in batch" processes are set up.</span></span> <span data-ttu-id="d10d0-140">Det anbefales, at du konfigurerer denne batchproces til at køre flere gange i løbet af dagen og planlægger den, så den køres ved afslutningen af hver kørsel af P-job.</span><span class="sxs-lookup"><span data-stu-id="d10d0-140">We recommend that you configure this batch process to run multiple times in a day and schedule it so that it runs at the end of every P-job execution.</span></span>

## <a name="results-of-validation-process"></a><span data-ttu-id="d10d0-141">Resultater af valideringsprocessen</span><span class="sxs-lookup"><span data-stu-id="d10d0-141">Results of validation process</span></span>

<span data-ttu-id="d10d0-142">Resultaterne af valideringskontrollen af batchprocessen markeres på den relevante transaktion.</span><span class="sxs-lookup"><span data-stu-id="d10d0-142">The results of the validation check by the batch process are tagged on the appropriate transaction.</span></span> <span data-ttu-id="d10d0-143">Feltet **Valideringsstatus** på transaktionsposten er enten angivet til **Fuldført** eller **Fejl**, og datoen for den seneste valideringskørsel vises i feltet **Sidste valideringstidspunkt**.</span><span class="sxs-lookup"><span data-stu-id="d10d0-143">The **Validation status** field on the transaction record is either set to **Successful** or **Error**, and the date of the last validation run appears on the **Last validation time** field.</span></span>

<span data-ttu-id="d10d0-144">For at få vist mere beskrivende fejltekst, der vedrører en valideringsfejl, skal du vælge den relevante butikstransaktionspost og klikke på knappen **Valideringsfejl**.</span><span class="sxs-lookup"><span data-stu-id="d10d0-144">To view more descriptive error text relating to a validation failure, select the relevant store transaction record and click the **Validation errors** button.</span></span>

<span data-ttu-id="d10d0-145">Transaktioner, der ikke består valideringskontrollen, og transaktioner, der endnu ikke blevet valideret, trækkes ikke ind i opgørelser.</span><span class="sxs-lookup"><span data-stu-id="d10d0-145">Transactions that fail the validation check and transactions that have not yet been validated will not be pulled into statements.</span></span> <span data-ttu-id="d10d0-146">Under processen "Beregn opgørelse" får brugere besked, hvis der findes posteringer, der kunne have været medtaget i opgørelsen, men ikke blev det.</span><span class="sxs-lookup"><span data-stu-id="d10d0-146">During the "Calculate statement" process, users will be notified if there are transactions that could have been included in the statement but weren't.</span></span>

<span data-ttu-id="d10d0-147">Hvis der findes en valideringsfejl, er den eneste måde at rette fejlen på, at kontakte Microsoft Support.</span><span class="sxs-lookup"><span data-stu-id="d10d0-147">If a validation error is found, the only way to fix the error is to contact Microsoft Support.</span></span> <span data-ttu-id="d10d0-148">I en senere version vil der blive tilføjet en funktion, så brugerne kan rette de poster, hvor der opstod fejl, via brugergrænsefladen.</span><span class="sxs-lookup"><span data-stu-id="d10d0-148">In a future release, capability will be added so that users can fix the records that failed through the user interface.</span></span> <span data-ttu-id="d10d0-149">Logførings- og overvågningsfunktioner vil også blive tilgængelige, så historikken over ændringerne kan spores.</span><span class="sxs-lookup"><span data-stu-id="d10d0-149">Logging and auditing capabilities will also be made available to trace the history of the modifications.</span></span>

> [!NOTE]
> <span data-ttu-id="d10d0-150">Der tilføjes yderligere valideringsregler for at understøtte flere scenarier i en senere version.</span><span class="sxs-lookup"><span data-stu-id="d10d0-150">Additional validation rules to support more scenarios will be added in a future release.</span></span>


[!INCLUDE[footer-include](../includes/footer-banner.md)]